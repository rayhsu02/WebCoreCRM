!function(){"use strict";function a(a,b,c){a.otherwise("/CustomerList"),b.state("CustomerList",{url:"/CustomerList",templateUrl:"/templates/CustomerList.html",controller:"customerController"}).state("CustomerDetail",{url:"/CustomerDetail",templateUrl:"/templates/CustomerDetail.html",params:{selectedCustomer:null,primaryContact:null},controller:"customerDetailController"}).state("DocumentList",{url:"/DocumentList",templateUrl:"/templates/DocumentList.html",params:{selectedCustomer:null},controller:"documentController"})}angular.module("app",["ui.router","ngTable"]).config(a),a.$inject=["$urlRouterProvider","$stateProvider","$locationProvider"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){console.log("call init"),h(),n(),a.reset()}function h(){b.getAllCustomers().then(function(b){console.log(b),console.log("res.data"),b&&(a.allCustomers=b,console.log("$scope.allCustomers"),console.log(a.allCustomers),a.customerList=new e({filter:{companyName:""}},{dataset:b}))})}function i(a){console.log("addCustomer"),console.log(a),void 0!=a.customerId?b.updateCustomer(a).then(function(a){console.log(a),h(),l()},function(){alert(res)}):b.addNewCustomer(a).then(function(a){console.log(a),h(),l()},function(){alert(res)})}function j(a){b.deleteCustomer(a).then(function(a){console.log(a),h(),l()},function(){alert(res)})}function k(a,b){console.log("goToState"),c.go(a,{selectedCustomer:b.customer,primaryContact:b.primaryContact})}function l(){a.reset(),$("#myModal").modal("hide")}function m(a){f.open("http://"+a,"_blank")}function n(){b.getIndustryTypes().then(function(b){console.log(b),a.IndustryTypes=b},function(){alert(res)})}a.title="customerController",a.allCustomers=[],a.customerList=[],a.getAllCustomer=h,a.addCustomer=i,a.deleteCustomer=j,a.goToState=k,a.IndustryTypes=[],a.getIndustryTypes=n,a.init=g,a.closeModal=l,a.newCompany={companyName:"",websiteUrl:"",industryTypeId:"",clientDesignation:!0},a.redirectTo=m,a.master={},a.reset=function(){console.log("reset")},a.showModal=!1,a.buttonClicked="",a.toggleModal=function(b){console.log(b),"new"==b?a.newCompany={companyName:"",websiteUrl:"",industryTypeId:"",clientDesignation:!0}:(b.industryTypeId=b.industryTypeId.toString(),a.newCompany=angular.copy(b)),a.showModal=!a.showModal},a.init()}angular.module("app").controller("customerController",a),a.$inject=["$scope","crmService","$state","$filter","NgTableParams","$window"]}(),function(){"use strict";function a(a){function b(){return a.get("/api/Customers/").then(p,q("Error getting all customers"))}function c(b){return a.post("/api/Customers/",b)}function d(b){return a.put("/api/Customers/"+b.customerId,b)}function e(b){return a.delete("/api/Customers/"+b.customerId)}function f(b){return a.get("/api/CustomerContacts/GetCustomerContactsByCustomerID/"+b).then(p,q("Error getting contacts"))}function g(b){return a.post("/api/CustomerContacts/",b)}function h(b){return a.put("/api/CustomerContacts/"+b.customerContactId,b)}function i(b){return console.log("deleteContact"),console.log(b),a.delete("/api/CustomerContacts/"+b.customerContactId)}function j(){return a.get("/api/IndustryTypes/").then(p,q("Error getting Industry Types"))}function k(b,c){for(var d=b.files,e=new FormData,f=0;f<d.length;f++)e.append(d[f].name,d[f]);return e.append("customerId",JSON.stringify(c)),console.log("addFile data"),console.log(e),a.post("/api/CustomerDocuments/",e,{headers:{"Content-Type":void 0},transformRequest:angular.identity})}function l(b){return a.get("/api/CustomerDocuments/GetCustomerDocumentsByCustomerID/"+b).then(p,q("Error getting documents"))}function m(b){return a.get("/api/CustomerDocuments/"+b).then(p,q("Error getting Document"))}function n(b){return a.delete("/api/CustomerDocuments/"+b.fileId)}function o(b){return a.get("/api/CustomerDocuments/RequestSignatureOnDocument/"+b.fileId).then(p,q("Error requestSignatureOnDocument"))}function p(a){return a.data}function q(a){return function(){return{success:!1,message:a}}}return{getAllCustomers:b,addNewCustomer:c,updateCustomer:d,deleteCustomer:e,getCustomerContacts:f,addNewContact:g,updateContact:h,deleteContact:i,getIndustryTypes:j,addFile:k,getCustomerDocumentsByCustomerID:l,deleteDocument:n,getCustomerDocumentByDocId:m,requestSignatureOnDocument:o}}angular.module("app").factory("crmService",a),a.$inject=["$http"]}(),function(){"use strict";function a(a){function b(a,b,c){a.$watch(c.visible,function(a){1==a?$(b).modal("show"):$(b).modal("hide")}),$(b).on("shown.bs.modal",function(){a.$apply(function(){a.$parent[c.visible]=!0})}),$(b).on("hidden.bs.modal",function(){a.$apply(function(){a.$parent[c.visible]=!1})})}return{templateUrl:"/templates/CustomerContactsModal.html",restrict:"E",transclude:!0,replace:!0,scope:!0,link:b}}angular.module("app").directive("customerContact",a),a.$inject=["$window"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){m()}function g(a){console.log("updateCustomer"),console.log(a),void 0!=a.customerId&&b.updateCustomer(a).then(function(a){console.log(a),c.go("CustomerList")},function(){alert(res)})}function h(b){console.log("showContactModal 2"),a.showModal=!a.showModal,console.log("$scope.newCompany 2"),console.log(a.newCompany),a.showModal&&(console.log("$scope.newCompany"),console.log(a.newCompany),j(),k(a.newCompany.customerId))}function i(c){console.log("select customer id"),console.log(a.newCompany.customerId),c.customerId=a.newCompany.customerId,void 0!=c.customerContactId?b.updateContact(c).then(function(b){console.log("updateContact"),console.log(b),k(a.newCompany.customerId)},function(){alert(res)}):b.addNewContact(c).then(function(b){console.log("addNewContact"),console.log(b),j(),k(a.newCompany.customerId)},function(){alert(res)})}function j(){console.log("resetContact"),a.newContact={firstName:"",lastName:"",email:"",phoneNumber:"",primaryContact:!1,customerId:a.newCompany.customerId}}function k(c){b.getCustomerContacts(c).then(function(b){console.log("getContactsList"),console.log(b),a.contacts=new e({},{dataset:b})},function(){alert(res)})}function l(b){console.log("getContact"),console.log(b),a.newContact=b}function m(){b.getIndustryTypes().then(function(b){console.log(b),a.IndustryTypes=b},function(){alert(res)})}function n(c){b.deleteContact(c).then(function(b){k(a.newCompany.customerId)},function(){alert(res)})}this.title="customerDetailController",console.log("$state.params.selectedCustomer"),console.log(c.params.selectedCustomer),console.log("$state.params.primaryContact"),console.log(c.params.primaryContact),a.newCompany=c.params.selectedCustomer,a.primaryContact=c.params.primaryContact,a.updateCustomer=g,a.IndustryTypes=[],a.getIndustryTypes=m,a.deleteContact=n,a.newContact={firstName:"",lastName:"",email:"",phoneNumber:"",primaryContact:!1,customerId:a.newCompany.customerId},a.phoneNumbr=/^\+?\d{2}[- ]?\d{3}[- ]?\d{5}$/,a.showContactModal=h,a.addContact=i,a.resetContact=j,a.getContactsList=k,a.getContact=l,a.contacts=[],f(),a.showModal=!1,a.buttonClicked=""}angular.module("app").controller("customerDetailController",a),a.$inject=["$scope","crmService","$state","$filter","NgTableParams"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){console.log("selectedCustomer"),console.log(a.selectedCustomer),i(a.selectedCustomer.customerId)}function h(){console.log("addFile");var c=$("#file").get(0);console.log(c),b.addFile(c,a.selectedCustomer.customerId).then(function(b){i(a.selectedCustomer.customerId)},function(){alert(res)})}function i(c){b.getCustomerDocumentsByCustomerID(c).then(function(b){a.documentList=new e({},{dataset:b})},function(){alert(res)})}function j(c){b.deleteDocument(c).then(function(b){i(a.selectedCustomer.customerId)},function(){alert(res)})}function k(a){console.log("view file"),console.log(a),f.open("/api/CustomerDocuments/"+a.fileId)}function l(a){b.requestSignatureOnDocument(a).then(function(a){console.log("requestSignOnDocument sent")},function(){alert(res)})}a.selectedCustomer=c.params.selectedCustomer,a.addFile=h,a.getCustomerDocumentsByCustomerID=i,a.documentList=[],a.deleteDocument=j,a.viewFile=k,a.requestSignOnDocument=l,g()}angular.module("app").controller("documentController",a),a.$inject=["$scope","crmService","$state","$filter","NgTableParams","$window"]}(),function(){"use strict";function a(){function a(a,b,c){a.$watch(c.visible,function(a){1==a?$(b).modal("show"):$(b).modal("hide")}),$(b).on("shown.bs.modal",function(){a.$apply(function(){a.$parent[c.visible]=!0})}),$(b).on("hidden.bs.modal",function(){a.$apply(function(){a.$parent[c.visible]=!1})})}return{templateUrl:"/templates/customerModal.html",restrict:"E",transclude:!0,replace:!0,scope:!0,link:a}}angular.module("app").directive("newCustomer",a)}();